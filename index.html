<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>قفل ترکیبی حرفه‌ای</title>
<link href="https://fonts.googleapis.com/css2?family=Vazir:wght@400;700&display=swap" rel="stylesheet">
<style>
* {margin:0; padding:0; box-sizing:border-box;}
body {
    background: radial-gradient(ellipse at center, #2a2a2a 0%, #1a1a1a 40%, #0a0a0a 100%);
    font-family: 'Vazir', sans-serif;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    overflow:hidden;
}

.myCenter {text-align:center;}

.myLock {
    display:inline-block;
    text-align:center;
    padding:40px 50px;
    background: linear-gradient(145deg,#f8f8f8 0%,#e8e8e8 20%,#d0d0d0 40%,#b8b8b8 60%,#a0a0a0 80%,#909090 100%);
    border-radius:30px;
    box-shadow:0 20px 40px rgba(0,0,0,0.5);
    max-width:95vw;
}

.lockWrapper {
    background: linear-gradient(180deg,#1a1a1a 0%,#2d2d2d 10%,#1a1a1a 20%,#0d0d0d 80%,#000 100%);
    border-radius:15px;
    height:240px;
    display:flex;
    justify-content:center;
    align-items:center;
    padding:10px;
    gap:10px;
    flex-wrap:nowrap; /* ❌ دیگر اجازه نمی‌دهد بره پایین */
}

.dial {
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:space-between;
    height:200px;
    width:80px;
    border-radius:10px;
    overflow:hidden;
    font-size:48px;
    font-family:'Vazir', monospace;
    font-weight:700;
    position:relative;
    color:#fff;
}

.arrow {
    cursor:pointer;
    font-size:28px;
    user-select:none;
    transition:transform 0.2s;
}
.arrow:hover {transform:scale(1.2);}

.dial-display {
    width:65px;
    height:75px;
    background:#000;
    border-radius:10px;
    display:flex;
    justify-content:center;
    align-items:center;
    box-shadow:inset 0 0 10px rgba(255,255,255,0.3);
    font-weight:bold;
    font-size:44px;
    color:#fff;
}

/* رنگ‌بندی */
.dial:nth-child(1){background:linear-gradient(180deg,#001133 0%,#002255 100%);}
.dial:nth-child(2){background:linear-gradient(180deg,#330000 0%,#ff0000 100%);}
.dial:nth-child(3){
    background:linear-gradient(180deg,#e6c200 0%,#ffee00 100%);
    color:#000;
}
.dial:nth-child(3) .dial-display {
    background:#fff7a1;
    color:#000;
}
.dial:nth-child(4){background:linear-gradient(180deg,#000 0%,#5a5a5a 100%);}

.btnEnter {
    font-size:22px;
    font-weight:700;
    cursor:pointer;
    margin:25px auto 0;
    width:280px;
    height:60px;
    line-height:60px;
    background:linear-gradient(145deg,#f0f0f0 0%,#e0e0e0 50%,#d0d0d0 100%);
    border-radius:30px;
    box-shadow:0 8px 16px rgba(0,0,0,0.2);
    transition:all 0.15s ease;
    display:flex;
    justify-content:center;
    align-items:center;
}

.modal {
    display:none;
    position:fixed;
    top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.7);
    justify-content:center;
    align-items:center;
    z-index:1000;
}
.modal.show{display:flex;}
.modal-content {
    background:white;
    padding:25px;
    border-radius:10px;
    text-align:center;
    width:90%;
    max-width:350px;
}

@keyframes shake {
    0%,100%{transform:translateX(0);}
    10%,30%,50%,70%,90%{transform:translateX(-5px);}
    20%,40%,60%,80%{transform:translateX(5px);}
}

/* 📱 واکنش‌گرایی بدون افتادن قفل */
@media (max-width: 600px) {
    body {padding:10px;}
    .myLock {padding:25px 20px;}
    .lockWrapper {height:200px; gap:6px;}
    .dial {width:60px; height:170px; font-size:36px;}
    .dial-display {width:50px; height:60px; font-size:34px;}
    .arrow {font-size:24px;}
    .btnEnter {width:220px; height:55px; font-size:20px;}
}
</style>
</head>
<body>
<div class="myCenter">
    <div id="lock" data-dials="4">
        <div class="status-display" id="statusDisplay">🔒 قفل شده</div>
    </div>
    <div class="btnEnter" id="enterBtn">🔓 باز کردن</div>
</div>

<div class="modal" id="successModal">
    <div class="modal-content">
        <h2>✅ رمز صحیح است!</h2>
        <p>پاکت را باز کنید.</p>
        <button id="closeModal">بستن</button>
    </div>
</div>

<script>
class CombinationLock {
    constructor(element, options = {}) {
        this.element = element;
        this.dials = options.dials || 4;
        this.correctCode = options.correctCode || '5263';
        this.currentCode = new Array(this.dials).fill(0);
        this.isLocked = true;
        this.init();
    }

    init() {
        this.buildLock();
        this.attachEvents();
    }

    buildLock() {
        this.element.className = 'myLock';
        const wrapper = document.createElement('div');
        wrapper.className = 'lockWrapper';

        for (let i = 0; i < this.dials; i++) {
            const dial = document.createElement('div');
            dial.className = 'dial';
            dial.dataset.index = i;

            const up = document.createElement('div');
            up.className = 'arrow';
            up.textContent = '▲';

            const display = document.createElement('div');
            display.className = 'dial-display';
            display.textContent = '0';

            const down = document.createElement('div');
            down.className = 'arrow';
            down.textContent = '▼';

            dial.appendChild(up);
            dial.appendChild(display);
            dial.appendChild(down);
            wrapper.appendChild(dial);
        }
        this.element.appendChild(wrapper);
    }

    attachEvents() {
        const dials = this.element.querySelectorAll('.dial');
        const enterBtn = document.getElementById('enterBtn');
        const modal = document.getElementById('successModal');

        dials.forEach((dial, index) => {
            const up = dial.querySelector('.arrow:first-child');
            const down = dial.querySelector('.arrow:last-child');
            up.addEventListener('click', () => this.changeNumber(index, -1));
            down.addEventListener('click', () => this.changeNumber(index, 1));
        });

        enterBtn.addEventListener('click', () => this.checkCode());
        document.getElementById('closeModal').addEventListener('click', () => {
            modal.classList.remove('show');
        });
    }

    changeNumber(index, dir) {
        this.currentCode[index] = (this.currentCode[index] + dir + 10) % 10;
        const dial = this.element.querySelectorAll('.dial')[index];
        const display = dial.querySelector('.dial-display');
        display.textContent = this.currentCode[index];
        this.playClickSound();
    }

    checkCode() {
        const entered = this.currentCode.join('');
        const status = document.getElementById('statusDisplay');
        const modal = document.getElementById('successModal');
        if (entered === this.correctCode) {
            this.isLocked = false;
            status.textContent = '✅ باز شد!';
            modal.classList.add('show');
            this.playSuccessSound();
        } else {
            status.textContent = '❌ رمز اشتباه';
            this.shakeAnimation();
            this.playErrorSound();
        }
        setTimeout(() => {
            status.textContent = this.isLocked ? '🔒 قفل شده' : '🔓 باز';
        }, 2000);
    }

    shakeAnimation() {
        const lock = this.element;
        lock.style.animation = 'shake 0.5s ease-in-out';
        setTimeout(() => lock.style.animation = '', 500);
    }

    playClickSound(){ if(navigator.vibrate) navigator.vibrate(30); }
    playSuccessSound(){ if(navigator.vibrate) navigator.vibrate([100,50,100]); }
    playErrorSound(){ if(navigator.vibrate) navigator.vibrate([200,100,200]); }
}

document.addEventListener('DOMContentLoaded', () => {
    new CombinationLock(document.getElementById('lock'), { correctCode: '5263' });
});
</script>
</body>
</html>
